<template>  <div class="list">    <div class="list-box">      <!-- tab切换 -->      <TabList @activeItem="activeItem" />      <!-- 数组 -->      <div class="item" @click="item.contentType === 'IMAGE' ? '' : jumpDetails(item)" v-for="item in dataList" :key="item.id">        <img :src="setUrl(item) || $Placeholder" alt="" />        <template v-if="item.contentType === 'IMAGE'">          <div class="xmgxc">            <!-- <img :preview="index" :src="item2.url" :large="item2.url" v-for="item2 in item.imageUrls" :key="item2.id" /> -->            <img @click="picture(item)" :src="setUrl(item) || $Placeholder" alt="" />          </div>        </template>        <div class="box">          <div class="title">{{ item.title }}</div>          <div class="text">            {{ item.summary }}          </div>          <div class="time" v-show="['NewsCenter'].includes($route.query.channelCode) || ['Activities'].includes($route.query.tab)">            {{ item.publishTime }}          </div>        </div>      </div>      <!-- 点击加载 -->      <template v-if="dataList.length">        <div class="paging" v-show="pageObj.currPage < totalPage && !isSkeleton">          <div @click="page(1)">Click on the load</div>        </div>        <!-- <div class="paging" v-show="params.currPage === totalPage && !isSkeleton">          <div>We don't have any more data</div>        </div> -->      </template>      <!-- 骨架屏 -->      <ImgSkeleton v-show="isSkeleton && params.currPage === 1" :num="3" />      <!-- 暂无数据 -->      <!-- <img v-if="!isSkeleton && dataList.length === 0" class="no-data" src="https://file.daqsoft.com/uploadfile/server/geekui/padna/h5/en/ea214dcc-f5ee-4288-932d-5fefc39f7f3f.gif" alt=""/> -->      <Notice v-model="isNotice" v-if="imgList.length" :list="imgList"/>    </div>  </div></template><script>import ImgSkeleton from '@/components/h5Skeleton/ImgSkeleton.vue'import TabList from '@/views/English/components/TabList.vue'import { getSimplifyList } from '@/service/apiList/common'import Notice from '@/components/Notice/index.vue'import record from '@/mixin/record'export default {  mixins:[record],  name: 'EnList',  components: {    TabList,    ImgSkeleton,    Notice  },  data() {    return {      params: {        channelCode: '',        pageSize: 5,        currPage: 1,      },      isNotice: false,      isSkeleton: false,      totalPage: 0,      dataList: [],      imgList: [],      isPreview: ['Wallpapers'],    }  },  computed: {    setUrl() {      return (item) => {        if (item.contentType === 'IMAGE') {          return item.imageUrls[0].url        }        if(item.contentType === 'VIDEO') {          return item.video.imgUrl        }        return item.cover      }    },  },  methods: {    async activeItem(item) {      this.params.channelCode = item      this.params.currPage = 1      this.dataList = []      const obj = JSON.parse(sessionStorage.getItem('cache'))      if(obj && obj.name === this.$route.fullPath) {        // 第一次拿到前几页的数据        this.params.channelCode = obj.params.channelCode        this.params.pageSize = 5 * obj.params.currPage        this.params.currPage = 1        await this.getList()        // 下一次点击加载更多时在分页        this.params = obj.params        window.scrollTo(0,obj.top)      }else {        this.getList()      }      this.removeCache()    },    picture(item) {      this.imgList = []      this.isNotice = true      this.imgList = item.imageUrls    },    async getList() {      this.isSkeleton = true      const res = await getSimplifyList(this.params)      if (res.code === 0) {        try {          this.totalPage = res.page.totalPage          if (this.params.currPage === 1) {            this.dataList = res.datas            // this.dataList = []          } else {            this.dataList.push(...res.datas)          }          this.pageObj = res.page          this.isSkeleton = false        } catch (error) {          return ''        }        this.$previewRefresh()      }    },    page(num) {      this.params.currPage += num      this.getList()    },    // 跳转详情    jumpDetails(item) {      this.$router.push({        path: '/h5/details',        query: {          channelCode: this.$route.query.channelCode,          id: item.id,          tab: this.params.channelCode,        },      })    },  },}</script><style lang="scss" scoped>.list {  // padding-top: 0.49rem;  // margin-top: calc(-100vh + 1.2rem);  // min-height: calc(100vh - 1.2rem);  height: 100%;  padding-bottom: 0.64rem;  &-box {    padding: 0.58rem 0 0.32rem;    width: 7.5rem;    // min-height: calc(100vh - 1.2rem);    height: 100%;    border-radius: 0.3rem;    // background: rgba(255, 255, 255, 0.5);    .item {      padding: 0 0.4rem;      margin-bottom: 0.32rem;      position: relative;      img {        width: 6.7rem;        height: 3.76rem;        position: relative;      }      .box {        width: 100%;        background: #f5f5f5;        padding: 0.3rem;        .title {          line-height: 0.48rem;          color: #333;          font-size: 0.3rem;          font-weight: bold;          @include ellipsisLn(2);        }        .text {          font-size: 0.22rem;          color: #666;          line-height: 0.36rem;          @include ellipsisLn(3);        }        .time {          margin-top: 0.1rem;          font-size: 0.22rem;          color: #666;        }      }      .xmgxc {        position: absolute;        top: 0;        opacity: 0;        z-index: 10;        height: 3.76rem;        width: 6.7rem;        overflow: hidden;      }    }  }  .paging {    margin: auto;    display: flex;    width: 4rem;    justify-content: space-around;    color: #666;    div {      font-weight: 500;      font-size: 0.24rem;      padding: 0.14rem 0.4rem;      white-space: nowrap;      line-height: 1;      border-radius: 0.26rem;      border: 0.01rem solid #d8d8d8;    }  }  .no-data {    height: 3.83rem;;    position: relative;    left: 50%;    transform: translateX(-50%);  }}</style>