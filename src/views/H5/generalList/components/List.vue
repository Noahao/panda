<template>  <div>    <div class="list" v-if="list.length">      <!-- 标题 -->      <div class="title" v-if="list.length">{{ list[0].channelName }}</div>      <div v-if="params.channelCode === 'xmyst'" class="summary">{{ summary }}</div>      <div class="the-booth" v-if="['dxmkpzs'].includes(activeItem.channelCode)">        <div class="item" @click="jump(item)" v-for="item in list" :key="item.id">          <div class="box">            <div class="title">{{ item.title }}</div>            <div class="text" v-if="item.summary">{{ item.summary }}</div>          </div>        </div>      </div>      <div v-else-if="['swzl'].includes(activeItem.channelCode)" class="list-box">        <ul>          <li @click="jumpDetails(item, 'ykfw')" v-for="item in list" :key="item.id">{{ item.title }}</li>        </ul>      </div>      <div class="video-list" v-else-if="['xmbz', 'xmyst', 'xmyl', 'xmsp', 'xmgxc', 'xmys', 'xmmsg', 'xmyy', 'xmmsg'].includes(activeItem.channelCode)">        <div class="item" v-for="item in list" :key="item.id" @click=";['xmbz', 'xmgxc'].includes(activeItem.channelCode) ? '' : jumpDetails(item, 'xmwh')">          <!-- 熊猫谷相册  壁纸-->          <template v-if="['xmgxc', 'xmbz'].includes(activeItem.channelCode)">            <div class="xmgxc">              <!-- <img :preview="item.id" :large="item2.url || $Placeholder" :src="item2.url" v-for="item2 in item.imageUrls" :key="item2.id" /> -->              <img @click="picture(item)" :src="item.cover || $Placeholder" alt="" />            </div>            <img :src="item.cover || $Placeholder" alt="" />          </template>          <img v-else :src="item.contentType === 'VIDEO' ? item.video.imgUrl : item.cover || $Placeholder" alt="" />          <div class="bg">{{ item.title }}</div>        </div>      </div>      <div class="troupe-list" v-else-if="[].includes(activeItem.channelCode)">        <div class="item" @click="jumpDetails(item, 'xmwh')" v-for="item in list" :key="item.id">          <img :src="item.cover || $Placeholder" alt="" />          <div class="left">            <div class="name">{{ item.title }}</div>            <div class="text">              {{ item.summary }}            </div>            <div class="look">查看作品 <MyIcon name="changjiantou" size="0.26rem" color="#666" /></div>          </div>        </div>      </div>      <div class="focus-list" v-else>        <div class="item" @click="jumpDetails(item, banner)" v-for="item in list" :key="item.id">          <img :src="item.cover || $Placeholder" alt="" />          <div class="box">            <div class="title">{{ item.title }}</div>            <div class="text" v-if="item.summary">{{ item.summary }}</div>            <div class="time" v-if="!isShow.includes(params.channelCode)">{{ item.publishTime }}</div>          </div>        </div>      </div>      <template v-if="list.length">        <div class="paging" v-show="pageObj.currPage < totalPage && !isSkeleton">          <div @click="page(1)">点击加载</div>        </div>        <div class="paging" v-show="params.currPage === totalPage && !isSkeleton">          <!-- <div>没有更多数据啦</div> -->        </div>      </template>    </div>    <ImgSkeleton v-if="isSkeleton && params.currPage === 1" :num="3" />    <!-- 暂无数据 -->    <NoData v-if="!isSkeleton && list.length === 0" />    <Notice v-model="isNotice" v-if="imgList.length" :list="imgList"/>  </div></template><script>import ImgSkeleton from '@/components/h5Skeleton/ImgSkeleton.vue'import { getSimplifyList, getChannelDetail } from '@/service/apiList/common'import NoData from '@/components/NoData.vue'import Notice from '@/components/Notice/index.vue'import record from '@/mixin/record'export default {  name: 'ListBox',  mixins:[record],  inject: ['jumpDetails'],  components: { ImgSkeleton, NoData, Notice },  props: {    activeItem: {      type: Object,      default: () => {        return {}      },    },  },  data() {    return {      isNotice: false,      isSkeleton: false,      banner: '',      imgList: [],      params: {        channelCode: '',        pageSize: 6,        currPage: 1,      },      isShow: ['nbnm', 'gnhz','kpcg', 'zyzzj', 'hdyy'],      list: [],      totalPage: 0, // 分页数    }  },  watch: {    activeItem: {      async handler(val) {        this.params.channelCode = val.channelCode        this.banner = val.banner        this.params.currPage = 1        this.params.pageSize = 6        this.list = []        const obj = JSON.parse(sessionStorage.getItem('cache'))        if(obj && obj.name === this.$route.fullPath) {          this.params.channelCode = obj.params.channelCode          // 第一次拿到前几页的数据          this.params.channelCode = obj.params.channelCode          this.params.pageSize = 5 * obj.params.currPage          this.params.currPage = 1          await this.getNewsList()          // 下一次点击加载更多时在分页          this.params = obj.params          window.scrollTo(0,obj.top)        }else {          this.getNewsList()        }        this.removeCache()        this.getChannelDetail()      },      immediate: true,      deep: true,    },  },  methods: {    async getNewsList() {      this.isSkeleton = true      const res = await getSimplifyList(this.params)      if (res.code === 0) {        try {          this.totalPage = res.page.totalPage          this.$previewRefresh()          if (this.params.currPage === 1) {            this.list = res.datas          } else {            this.list.push(...res.datas)          }          this.pageObj = res.page        } catch (error) {          return ''        }      }      this.isSkeleton = false    },    async getChannelDetail() {      const res = await getChannelDetail(this.params)      if (res.code === 0) {        this.summary = res.data.summary      }    },    page(num) {      this.params.currPage += num      this.getNewsList()    },    jump(item) {      this.$router.push({        path: '/h5/details',        query: {          id: item.id,          channelCode: 'kpjy',          tab: 'kpzlk',        },      })    },    picture(item) {      this.imgList = []      this.isNotice = true      this.imgList = item.imageUrls    }  },}</script><style lang="scss" scoped>.list {  padding: 0.6rem 0.3rem;  > .title {    padding: 0 0 0.5rem;    font-weight: Bold;    font-size: 0.46rem;    text-align: center;    color: #333333;    line-height: 1;  }  > .summary {    text-indent: 0.48rem;    font-size: 0.24rem;    color: #666666;    line-height: 0.36rem;    text-align: center;    margin-bottom: 0.4rem;  }  > .list-box {    margin-bottom: 0.79rem;    ul {      padding: 0 0 0.5rem ;      border-bottom: 0.01rem solid #d9d9d9;      li {        color: #333333;        font-size: 0.24rem;        line-height: 0.6rem;        position: relative;        padding-left: 0.3rem;        @include ellipsis();        &:hover {          color: #15a98d;        }        &::after {          position: absolute;          left: 0;          top: 50%;          transform: translate(0, -50%);          content: '';          width: 0.1rem;          height: 0.1rem;          border: 0.02rem solid#666666;          border-radius: 50%;        }      }    }  }  > .focus-list {    > .item {      background: rgba(245, 245, 245, 1);      margin-bottom: 0.4rem;      > img {        width: 100%;        height: 3.83rem;      }      > .box {        padding: 0.4rem 0.2rem;        .title {          font-weight: Bold;          font-size: 0.26rem;          line-height: 1;          color: #333333;          @include ellipsis();        }        .text {          text-indent: 0.48rem;          margin-top: 0.3rem;          font-size: 0.24rem;          color: #666666;          line-height: 0.36rem;          @include ellipsisLn(2);        }        .time {          margin-top: 0.28rem;          font-weight: 500;          font-size: 0.2rem;          color: #999999;          line-height: 1;        }      }    }  }  > .the-booth {    margin: 0 0 0.4rem;    .item {      background: rgba(245, 245, 245, 1);      margin-bottom: 0.4rem;    }    .box {      padding: 0.4rem 0.2rem;      .title {        font-weight: Bold;        font-size: 0.26rem;        line-height: 1;        color: #333333;        @include ellipsis();      }      .text {        text-indent: 0.48rem;        margin-top: 0.3rem;        font-size: 0.24rem;        color: #666666;        line-height: 0.36rem;        @include ellipsisLn(2);      }    }  }  > .video-list {    margin-bottom: 0.2rem;    > .item {      margin-bottom: 0.5rem;      position: relative;      > img {        position: relative;        width: 100%;        height: 3.88rem;      }      .xmgxc {        opacity: 0;        z-index: 10;        position: absolute;        height: 3.88rem;        overflow: hidden;      }      > .bg {        padding: 0 0.2rem;        position: absolute;        bottom: 0;        width: 6.9rem;        height: 0.79rem;        background: rgba(0, 0, 0, 0.3);        font-weight: 500;        color: #ffffff;        font-size: 0.24rem;        text-align: center;        line-height: 0.79rem;        @include ellipsis(100%);      }    }  }  > .troupe-list {    .item {      margin-bottom: 0.6rem;      display: flex;      img {        width: 2rem;        height: 2.8rem;        object-fit: cover;      }      .left {        margin-left: 0.24rem;        flex: 1;        position: relative;        .name {          font-weight: Bold;          line-height: 1;          margin-bottom: 0.35rem;          font-size: 0.36rem;          @include ellipsis();        }        .text {          text-indent: 0.48rem;          font-size: 0.36rem;          color: #666666;          font-size: 0.24rem;          @include ellipsisLn(4);        }        .look {          position: absolute;          bottom: 0.16rem;          font-weight: 500;          font-size: 0.2rem;          color: #999999;          display: flex;          line-height: 1;          align-items: center;          i {            margin-left: 0.1rem;          }        }      }    }  }  .paging {    margin: auto;    display: flex;    width: 4rem;    color: #666;    justify-content: space-around;    div {      font-weight: 500;      font-size: 0.26rem;      padding: 0.14rem 0.4rem;      line-height: 1;      border-radius: 0.24rem;      border: 0.01rem solid #d8d8d8;    }  }}</style>